---
title: "p8105_hw5_yw4199"
author: "Yaduo Wang"
date: "2023-11-13"
output: github_document
---

```{r}
library(tidyverse)

# Setting options. 
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


## Problem 2

```{r}
#get names of all files
file_name_list = list.files(path = "data", pattern = "*.csv", full.names = TRUE)

#Create a tidy dataframe containing data from all participants, including the subject ID, arm, and observations over time:
file_name_df = data_frame(file_name_list)
file_df = 
  file_name_df |> 
  map_dfr(read_csv) |> 
  mutate(subject_id = substring(file_name_list, 10, 11),
           arm = substring(file_name_list, 6, 8)) |> 
  mutate(
    arm = 
      case_match(
        arm, 
        "con" ~ "control", 
        "exp" ~ "experiment")) |> 
  relocate(arm, subject_id) |> 
  pivot_longer(
    week_1:week_8,
    names_to = "week", 
    values_to = "value") |> 
  mutate(week = substring(week, 6,6))
  
```

```{r}
# Make a spaghetti plot showing observations on each subject over time, and comment on differences between groups.
file_df |> 
  group_by(arm, subject_id) |> 
  ggplot(aes(x = week, y = value, color = interaction(arm, subject_id)))+
  geom_line()+
  labs(title = "Observations on Each Subject over Time",
       x = "Week",
       y = "Observation Value")
```

